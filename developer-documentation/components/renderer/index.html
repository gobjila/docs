<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.backbee.com/developer-documentation/components/renderer/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Renderer - The BackBee documentation</title>

        <link href="../../../css/gen.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-3459992-27', 'docs.backbee.com');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../.."><img src="../../../img/logo-bb-docs.png" alt="The BackBee documentation" title="The BackBee documentation" height="28" style="vertical-align:bottom;" /> <b>Documentation</b></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../../..">Introduction</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developer documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../requirements/">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../../installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../architecture/">Architecture</a>
                        </li>
                    
                        <li >
                            <a href="../../configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../../project_architecture/">Project Architecture</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbooks <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../cookbooks/create_bundle_administration/">Create bundle administration</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/create_new_commands/">Create new commands</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/create_new_templating_helpers/">Create new templating helpers</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/customize_error_pages/">Customize error pages</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/ease_debugging_with_profiler/">Ease debugging with the Web Profiler</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/use_swift_mailer_in_backbee/">Use Swift Mailer in BackBee</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/layout_creation/">Layout creation using LayoutBuilderBundle</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../bundle/">Bundle</a>
                        </li>
                    
                        <li >
                            <a href="../cache/">Cache</a>
                        </li>
                    
                        <li >
                            <a href="../classcontent/">ClassContent</a>
                        </li>
                    
                        <li >
                            <a href="../config/">Config</a>
                        </li>
                    
                        <li >
                            <a href="../event_listener/">Event Listener</a>
                        </li>
                    
                        <li >
                            <a href="../nested_node/">Nested Node</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Renderer</a>
                        </li>
                    
                        <li >
                            <a href="../routing/">Routing</a>
                        </li>
                    
                        <li >
                            <a href="../security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="../translation/">Translation</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../nested_node/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../routing/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/backbee/docs">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container" id="main-container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#components">Components</a></li>
        
            <li><a href="#the-renderer-component">The Renderer Component</a></li>
        
            <li><a href="#the-big-picture">The Big picture</a></li>
        
            <li><a href="#renderer-adapters-and-manageable-extensions">Renderer adapters and manageable extensions</a></li>
        
            <li><a href="#render-a-page-classcontent">Render a Page / ClassContent</a></li>
        
            <li><a href="#partial-rendering">Partial rendering</a></li>
        
            <li><a href="#asset-management">Asset management</a></li>
        
            <li><a href="#global-variables">Global variables</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">
                

<h1 id="components">Components</h1>
<h2 id="the-renderer-component">The Renderer Component</h2>
<p>The Renderer component is used to render any content from BackBee core.
It provides a <code>Renderer</code> object able to:</p>
<ul>
<li>Search for templates according to available adapters;</li>
<li>Render BackBee <code>Page</code> but also any <code>ClassContent</code>;</li>
<li>Accept multiple rendering modes for each content to be rendered;</li>
<li>Can Render only an HTML fragment;</li>
<li>Manage Web assets (CSS and Javascripts).</li>
</ul>
<h2 id="the-big-picture">The Big picture</h2>
<p>Let's start with a schema that represents BackBee architecture on a simple page:</p>
<p><img alt="the BackBee big picture" src="http://i.imgur.com/sLLJ19x.png" title="the BackBee big picture" /></p>
<p>Each element has an objective representation inside <strong>BackBee core library</strong>:</p>
<ul>
<li><strong>Site</strong> (<code>BackBuilder\Site\Site</code>) is your application.</li>
<li><strong>Page</strong> (<code>BackBuilder\NestedNode\Page</code>) represents each page of your application, for example BackBee CMS provide three pages: home page, article page and category page.</li>
<li><strong>Layout</strong> (<code>BackBuilder\Site\Layout</code>) represents the layout of a page.</li>
<li><strong>ContentSet</strong> (<code>BackBuilder\ClassContent\ContentSet</code>) represent the blocks/columns of layouts, which can be edited by user.</li>
</ul>
<p>When an user accesses to a page, the <code>Renderer::render()</code> method is called.</p>
<blockquote>
<p>During the rendering process, three events are dispatched: <code>prerender</code>, <code>render</code> and <code>postrender</code>.</p>
</blockquote>
<h2 id="renderer-adapters-and-manageable-extensions">Renderer adapters and manageable extensions</h2>
<p>The BackBee Renderer Component is able to render different templating engines thanks to Adapters.
In BackBee Standard Edition, two adapters are provided:
<em> The <code>PHTML</code> Adapter
</em> The <code>Twig</code> Adapter</p>
<p>When BackBee tries to render content, it looks for a template and then it looks for the file extension.
If the extension file is part of manageable extensions and if an Adapter is found for this extension, the Adapter is called to render the template with the assigned variables.</p>
<p>To implement your own adapter, for <a href="http://www.smarty.net/">Smarty</a> you need to implement the <code>BackBee\Renderer\RendererAdapterInterface</code> interface.</p>
<pre><code class="php">&lt;?php

/*
 * Copyright (c) 2011-2015 Lp digital system
 *
 * This file is part of BackBee.
 *
 * BackBee is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * BackBee is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with BackBee. If not, see &lt;http://www.gnu.org/licenses/&gt;.
 *
 * @author Charles Rouillon &lt;charles.rouillon@lp-digital.fr&gt;
 */

namespace BackBee\Renderer;

use BackBee\Site\Layout;

/**
 * Interface for a renderer adapter.
 *
 * @category    BackBee
 *
 * @copyright   Lp digital system
 * @author      e.chau &lt;eric.chau@lp-digital.fr&gt;
 */
interface RendererAdapterInterface
{
    /**
     * Constructor; every RendererAdapter need to be construct with a AbstractRenderer
     *
     * @param AbstractRenderer $renderer
     */
    public function __construct(AbstractRenderer $renderer, array $config = []);

    /**
     * Returns array that contains every single file's extension managed by this adapter.
     *
     * @return array
     */
    public function getManagedFileExtensions();

    /**
     * Check if $filename exist in $templateDir; it also checks if the file is readable.
     *
     * @param string $filename
     * @param array  $templateDir array that contains every directories where it has to looking
     *                            for $filename
     *
     * @return boolean true if the filename was found into $templateDir and it's readable,
     *                 else it returns false
     */
    public function isValidTemplateFile($filename, array $templateDir);

    /**
     * Returns render of $filename template which is compute with $params and $vars.
     *
     * @param string $filename
     * @param array  $templateDir
     * @param array  $params
     *
     * @return string
     */
    public function renderTemplate($filename, array $templateDir, array $params = array(), array $vars = array());

    /**
     * Updates a file script of a layout.
     *
     * @param Layout $layout     The layout to update
     * @param string $layoutFile the layout with absolute path generated by ARendrer::updateLayout()
     *
     * @return string The filename of the updated script
     */
    public function updateLayout(Layout $layout, $layoutFile);

    /**
     * This is called everytime we clone a renderer.
     *
     * @param Renderer $renderer the new renderer
     */
    public function onNewRenderer(AbstractRenderer $renderer);

    /**
     * This is called everytime we restore previous renderer.
     *
     * @param Renderer $renderer the previous renderer
     */
    public function onRestorePreviousRenderer(AbstractRenderer $renderer);
}

</code></pre>

<p>An adapter can also extend <code>BackBee\Renderer\AbstractRendererAdapter</code> to help you focus only on templating engine specifications you want to support.</p>
<h2 id="render-a-page-classcontent">Render a Page / ClassContent</h2>
<p>Rendering a Page or a ClassContent starts in the <code>Renderer::render()</code> method:</p>
<pre><code>&lt;?php
// in the BackBee Renderer class
public function render(
    RenderableInterface $obj = null,
    $mode = null,
    $params = null,
    $template = null,
    $ignoreModeIfNotSet = false
    ){ /* rendering is done here */ }
}
</code></pre>

<p>If the object is an instance of <code>BackBee\Site\Page</code>, the function <code>renderPage</code> is called inside <code>render()</code> function.</p>
<ul>
<li>
<p>This method loads the Page Layout object and then loops into all the ContentSet objects, and for each ContentSet loop into all the ClassContents and try to render them.</p>
</li>
<li>
<p>Finally, it uses the template related to the layout through the method <code>renderTemplate</code> which calls the selected <code>Adapter::renderTemplate()</code> function.</p>
</li>
</ul>
<p>Else, if the object is not a Page instance, the function <code>renderContent()</code> is directly called.</p>
<p><em>If the object is nil or doesn't implement <code>RenderableInterface</code> interface, the Renderer doesn't return an exception but nothing.</em></p>
<h2 id="partial-rendering">Partial rendering</h2>
<p>BackBee Renderer component can render partial HTML fragments. Under the hood, this is the <code>renderPartial()</code> method which is used to render the HTML fragment.</p>
<pre><code class="php">// in the BackBee Renderer class

public function partial($template = null, $params = null)
{
    // return a partial content
}
</code></pre>

<p>To call a partial in your template, the file needs to be in <code>repository/Templates/scripts/partials</code> folder:</p>
<pre><code class="twig">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr&quot;&gt;

    {{ this.partial('partials/header-head.twig')|raw }}

    &lt;body&gt;
    &lt;!-- ... --&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<blockquote>
<p>If you use a partial, you can use the helpers to inject the styles and the javascripts because they are not called inside the partials.</p>
</blockquote>
<h2 id="asset-management">Asset management</h2>
<p>In addition, the BackBee Renderer Component provides nice helpers to help you add assets dynamically.</p>
<p>BackBee helps you add any resource available in your application, here is a list of available helpers:</p>
<ul>
<li><code>getImageUrl</code>, <code>getMediaUrl</code> and <code>getResourceUrl</code> : get any file from any <strong>Resource</strong> folder (both in application and bundles);</li>
<li><code>getUri</code> : get any file from the <code>public</code> folder of an BackBee application;</li>
<li><code>addStylesheet</code>, <code>addHeaderJs</code> and <code>addFooterJs</code> allowing you to generate the correct CSS or Javascript call. For the Javascript files you can choose to import Javascript in the <code>&lt;header&gt;</code> or in the bottom of the <code>&lt;body&gt;</code>;</li>
<li><code>getUrlByRouteName</code> is another helper to manage urls of an application.</li>
</ul>
<h2 id="global-variables">Global variables</h2>
<p>The BackBee Renderer Component embeds some useful variables in each template from the BackBee application.</p>
<pre><code class="php">&lt;?php
// in the BackBee Renderer class
/**
     * Returns default parameters that are availables in every templates.
     *
     * @return array
     */
    private function getBBVariable()
    {
        return [
            'bb' =&gt; [
                'debug'      =&gt; $this-&gt;getApplication()-&gt;isDebugMode(),
                'token'      =&gt; $this-&gt;getApplication()-&gt;getBBUserToken(),
                'request'    =&gt; $this-&gt;getApplication()-&gt;getRequest(),
                'routing'    =&gt; $this-&gt;getApplication()-&gt;getRouting(),
                'translator' =&gt; $this-&gt;getApplication()-&gt;getContainer()-&gt;get('translator'),
            ],
        ];
    }
</code></pre>

<p>Thanks to helpers, in template you can retrieve useful informations:</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
    &lt;body&gt;
        &lt;?php if($this-&gt;token !== null) ?&gt;
        Hi &lt;?php echo $this-&gt;token-&gt;getUser()-&gt;getUsername(); ?&gt;
        &lt;?php else : ?&gt;
        You are non authenticated.
        &lt;?php endif; ?&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>In BackBee Standard application, theses additional helpers are available:</p>
<ul>
<li><code>bbtoolbar()</code> : display the toolbar application. <em>You need to have an element with the CSS identifier <strong>bb5-site-wrapper</strong> or else the application has bad design behaviors</em>.</li>
<li><code>navbar()</code> : display a menu for all pages that have the "display in the menus" option activated.</li>
<li><code>container()</code> allows you to loop into the contentset of your layout and then, design your page.</li>
</ul>
<p>For a complete example, you can take a look at the <em>Article</em> layout:</p>
<pre><code class="twig">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr&quot;&gt;
    {{ this.partial('partials/header-head.twig')|raw }}
    &lt;body&gt;
        {{ this.bbtoolbar()|raw }} {# When logged, display the toolbar #}
        &lt;div id=&quot;bb5-site-wrapper&quot;&gt;
            {{ this.navbar()|raw }} {# display the menu #}
            &lt;!-- Some content --&gt;
            &lt;div class=&quot;row relative&quot; id=&quot;bb5-mainLayoutRow&quot;&gt;
                &lt;div class=&quot;col-sm-12 col-md-10&quot;&gt;
                    {{ this.container().first()|raw }}
                &lt;/div&gt;
                &lt;div class=&quot;col-md-2 visible-md&quot; id=&quot;sidebar&quot; data-scroller=&quot;true&quot;&gt;
                    {{ this.container().next()|raw }}
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;&lt;!-- End BackBee Site wrapper --&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
                <hr />
                <div class="contribution-message">
    <h2>Is something missing?</h2>
    <p>If you notice something we've missed or could be improved on, please follow <a href="https://github.com/backbee/docs/blob/master/README.md" target="_blank">this link</a> and submit a pull request to the BackBee documentation repository. Once we merge it, the changes will be immediately reflected on the website.</p>
</div>
            </div>
        </div>

    <footer>
        <hr>
        <p>Copyright &copy; 2014-2015, <a href="http://www.backbee.com">BackBee project</a>.</p>
        <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>

        <div class="footer-copyright">
            <div class="container">
                <ul class="row nav">
                    <li class="col-sm-6 col-xs-4"><a href=" http://www.lp-digital.fr/en/index.php" target="_blank"><img src="http://backbee.com/img/logo-lpdigital-bw.png" alt="Lp digital"></a></li>
                    <li class="col-sm-6 col-xs-8 text-align-right"><a href=" http://www.lp-digital.fr/en/solutions.php" target="_blank" class="btn btn-dimmed btn-sm">Our other solutions</a><!-- SocialTools -->
                        <div class="social-tool-wrapper">
                            <ul class="nav">
                                <li><a href="https://www.facebook.com/backbeeCMS" target="_blank"><i class="fa fa-facebook"></i><span class="visuallyhidden">Facebook</span></a></li>
                                <li><a href="https://twitter.com/Lpdigitalsystem" target="_blank"><i class="fa fa-twitter"></i><span class="visuallyhidden">Twitter</span></a></li>
                                <li><a href="https://plus.google.com/101416676508957143369/posts" target="_blank"><i class="fa fa-google-plus"></i><span class="visuallyhidden">Google +</span></a></li>
                                <li><a href="http://backbee.com/services/contact-us"><i class="fa fa-envelope"></i><span class="visuallyhidden">Contact Us</span></a></li>
                            </ul>
                        </div>
                        <!-- End SocialTools -->
                    </li>
                </ul>
            </div>
        </div>
    </footer>


        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
    </body>
</html>